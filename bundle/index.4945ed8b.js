const b=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}};b();const i={tap:new Audio("sounds/tap1.wav"),navForward:new Audio("sounds/nav1.flac"),refresh:new Audio("sounds/refresh.flac"),shutter:new Audio("sounds/shutter.flac")};i.tap.volume=.5;i.navForward.volume=.1;i.shutter.volume=.05;function p(){i.tap.play()}function m(){i.refresh.play()}function w(){i.shutter.play()}function v(e=!0){navigator.vibrate(10),e&&i.navForward.play()}var y=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",sounds:i,tap:p,refresh:m,shutter:w,navigate:v});const d=location.origin+document.querySelector('head > link[rel="root"]')?.getAttribute("href");k();const s={main:document.querySelector("body > main"),nav:document.querySelector("body > nav"),links:document.querySelectorAll("body > nav > [page]"),header:document.querySelector("body > header")},a={_values:[{_page:"home",get page(){return this._page},set page(e){this._page=e,u(e)}},...location.href.replace(d,"").split("/").filter(e=>e!="")],get first(){return this._values.length==1?this._values[0]:null},get current(){return this.first?.page??this._values[this._values.length-1]},back(){this.first||(this._values.pop(),history.back(),u(this.current))},async open(e){this._values.push(e),history.pushState(e,"",d+this._values.slice(1).join("/")),console.log(this._values),await u(e)}};window.stack=a;window.onpopstate=()=>a.back();u(a.current);async function u(e){if(document.body.removeAttribute("fullview"),s.main.removeAttribute("afterload"),s.main.innerHTML=await A(`/views/${e}.html`),document.querySelectorAll("[page]").forEach(t=>t.getAttribute("page")==e?t.setAttribute("active",""):t.removeAttribute("active")),s.main.setAttribute("afterload",""),!a.first){document.body.setAttribute("fullview",""),L();const t=s.main.querySelector("header");t&&(t.innerHTML="<button icon navback>arrow_back</button>"+t?.innerHTML),(t?.querySelector("[navback]")).onclick=()=>a.back()}}s.links.forEach(e=>e.addEventListener("click",()=>{a.first&&(a.first.page=e.getAttribute("page")),v()}));async function A(e){let o=await(await self.caches?.open("views"))?.match(e);return o||(s.nav.setAttribute("loading",""),o=await fetch(e),s.nav.removeAttribute("loading")),await o.text()}function k(){const e=window.fetch;window.fetch=(t,o)=>{if(t instanceof Request||!t.startsWith("/"))return e(t,o);const c=new URL("."+t,d).href;return e(c,o)}}const f={ripple(e){return e.getAttribute("ripple")!=null||e.getAttribute("page")!=null||e.nodeName=="BUTTON"||e.nodeName=="HEADER"||!1},dialog(e){return e.nodeName=="DIALOG"},view(e){return!!e.getAttribute("view")}},_=[{if:f.ripple,then(e){e.addEventListener("pointerdown",()=>g(e)),e.addEventListener("keydown",t=>{t.key=="Enter"&&g(e,10)})}},{if:f.dialog,then(e){e.setAttribute("open","")}},{if:f.view,then(e){e.onclick=()=>{const t=e.getAttribute("view");!t||a.open(t)}}}];function g(e,t=0){e.getAttribute("disabled")==null&&(e.removeAttribute("afterclick"),setTimeout(()=>e.setAttribute("afterclick",""),t),p())}function L(){document.querySelectorAll("[afterclick]").forEach(async e=>e.removeAttribute("afterclick"))}const E=new MutationObserver(e=>{e.forEach(t=>{t.addedNodes.forEach(o=>o.nodeName!="#text"?h(o):0)})});E.observe(document.body,{childList:!0,subtree:!0});document.querySelectorAll("body *").forEach(e=>h(e));function h(e){_.forEach(t=>{t.if(e)&&t.then(e)});for(const t in e.children){const o=e.children[t];o.getAttribute&&h(o)}}location.port!="3000"&&navigator.serviceWorker?.register(new URL("/pwa-template/sw.js",self.location).href);navigator.serviceWorker.onmessage=e=>{e.data=="update"&&location.reload()};const S=async()=>{if(!navigator.onLine){console.warn("%cCannot update caches while offline!","color: orange");return}navigator.serviceWorker.controller?.postMessage("update")};window.updateCaches=S;window.sounds=y;
